<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
    <title>Appointment Booking Service</title>
</head>
<body>

<h2>Add new student</h2>
Name: <input type="text" id="student"/>
<button onclick="addStudent()">Add</button>

<h2>List of students</h2>
<div id="studentList"></div>

<h2>Add new teacher</h2>

<form action="">
    <lablel for="TName">Name:</lablel>
    <input type="text" id="teacherName" required/>
    <lablel for="TAddress">Address:</lablel>
    <input type="text" id="teacherAddress" required/>
    <lablel for="TPhone">Contact:</lablel>
    <input type="text" id="teacherPhone" required/>
    <button onclick="addTeacher()">Add</button>
</form>


<h2>List of teachers</h2>
<div id="teacherList"></div>



<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"></script>
</body>
</html>

<script>

    getStudents()


    function addStudent() { //post

        var name = document.getElementById('student').value //get value from an html element

        fetch('http://localhost:8080/students', {
            headers: {
                'Accept': 'application/json',
                'Content-Type': 'application/json'
            },
            method: "POST",
            body: JSON.stringify({studentName: name})

        }).then(res => getStudents())


        console.log('Added')
    }

    function getStudents() {

        var studentList = document.getElementById('studentList')

        studentList.innerHTML = ''

        fetch('http://localhost:8080/students')
            .then(res => res.json())
            .then(json => {

                for (i = 0; i < json.length; i++) {

                    var id = json[i].id

                    var deleteLink = `<button onclick='deleteStudent(${id})'>Delete</button>`

                    studentList.innerHTML += '<div>' + json[i].studentName + deleteLink + '</div>'

                }

            })

    }


    function deleteStudent(id) {
        fetch('http://localhost:8080/students/' + id, {
            method: 'delete'
        })
            .then(res => getStudents())
    }

    getTeachers()

    function addTeacher() { //post
        var name = document.getElementById('teacherName').value //get value from an html element
        var address = document.getElementById('teacherAddress').value
        var phone = document.getElementById('teacherPhone').value

        if (name != '' && address != '' && phone != '') {
            fetch('http://localhost:8080/teachers', {
                headers: {
                    'Accept': 'application/json',
                    'Content-Type': 'application/json'
                },
                method: "POST",
                body: JSON.stringify({teacherName: name, teacherAddress: address, teacherPhone: phone})

            }).then(res => getTeachers())


            console.log('Added')
        }
    }

    function getTeachers() {

        var teacherList = document.getElementById('teacherList')

        teacherList.innerHTML = ''

        fetch('http://localhost:8080/teachers')
            .then(res => res.json())
            .then(json => {

                for (i = 0; i < json.length; i++) {

                    var id = json[i].id

                    var deleteLink = `<button onclick='deleteTeacher(${id})'>Delete</button>`

                    teacherList.innerHTML += '<div>' + json[i].teacherName + ' ' + json[i].teacherAddress + ' ' + json[i].teacherPhone + deleteLink + '</div>'

                }

            })

    }


    function deleteTeacher(id) {
        fetch('http://localhost:8080/teachers/' + id, {
            method: 'delete'
        })
            .then(res => getTeachers())
    }


</script>